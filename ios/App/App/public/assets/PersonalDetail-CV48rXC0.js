import{r as i,j as e,o as N,P as f,N as j,V as k,a as p,I as L,W as P,$ as t,x as R,L as m,X as S,U as T,m as x,f as h,O as w,p as b}from"./index-BMnTsVIf.js";import{L as A}from"./list-button-Wa9Up56A.js";import{L as C}from"./list-input-Y0iWo3cI.js";const _=({opened:c,onPopupClosed:r,title:o,send:n})=>{const[s,l]=i.useState("");return e.jsx(N,{opened:c,onPopupClosed:()=>r(!1),children:e.jsxs(f,{className:"bg-bgTertiary",children:[e.jsxs(j,{className:"hidden-navbar-bg bg-bgPrimary coss_remark",children:[e.jsx(k,{children:e.jsx(p,{popupClose:!0,children:e.jsx(L,{icon:"icon-back"})})}),e.jsx(P,{children:o||t("添加好友")}),e.jsx(R,{children:e.jsx(p,{onClick:async()=>{await n(s),r(!1)},children:t("发送")})})]}),e.jsx(m,{strongIos:!0,outlineIos:!0,dividersIos:!0,form:!0,formStoreData:!0,className:"bg-bgPrimary",children:e.jsx(C,{name:"name",type:"text",onChange:d=>l(d.target.value),clearButton:!0,autofocus:!0,placeholder:t("请输入备注信息")})})]})})},B=({f7route:c})=>{const r=c.params.user_id,o=i.useRef({el:null}),n=i.useRef(null),[s,l]=i.useState({}),d=()=>{const a=n.current.offsetHeight;o.current.el.querySelector(".page-content").scrollTop=a/2};S(async()=>{try{const{data:a}=await T.getUserInfoApi({user_id:r});l(a)}catch(a){console.error("获取用户信息失败",a)}},()=>{},[]);const[v,g]=i.useState(!1),y=async a=>{try{h.dialog.preloader(t("添加中..."));const{code:u}=await w.addFriendApi({user_id:r,remark:a,e2e_public_key:""});if(u!==200){b(t("添加失败"));return}b(t("添加成功,等待对方同意"))}catch(u){console.error(u)}finally{h.dialog.close()}};return e.jsxs(f,{ref:o,className:"profile-page bg-bgTertiary",noToolbar:!0,onPageInit:d,children:[e.jsx(j,{title:t("用户信息"),backLink:!0,className:"bg-bgPrimary hidden-navbar-bg"}),e.jsx("div",{className:"profile-avatar-block",ref:n,children:e.jsx("img",{src:s==null?void 0:s.avatar,alt:""})}),e.jsxs("div",{className:"profile-content",children:[e.jsxs(m,{strong:!0,outline:!0,dividers:!0,mediaList:!0,className:"no-margin-top m-0 mb-3 bg-white",children:[e.jsx(x,{title:s==null?void 0:s.nickname}),e.jsx(x,{subtitle:s==null?void 0:s.signature,text:s==null?void 0:s.email})]}),e.jsx(m,{strong:!0,outline:!0,dividers:!0,className:"bg-white m-0 mb-3",children:e.jsx(A,{onClick:()=>g(!0),children:t("添加好友")})})]}),e.jsx(_,{opened:v,onPopupClosed:g,send:y})]})};export{B as default};
