import{r as t,j as s,P as k,B as h,$ as a,L as j,c as i,t as l,b as P,d as I,U as M,f as v}from"./index-BMnTsVIf.js";import{L as n}from"./list-input-Y0iWo3cI.js";import{C as _,L as C,a as b,A as L,c as F}from"./Auth-RONbL0g7.js";import{v as A,a as B}from"./validate-6tRYFLtu.js";import"./tweetnacl-CZjkbTba.js";const z=({f7router:d})=>{const[r,o]=t.useState({nickname:"",email:"",password:"",confirm_password:""}),[p,c]=t.useState(""),[f,m]=t.useState(""),[x,u]=t.useState(""),[g,w]=t.useState(!1),N=()=>{let e=!1;return g?e:r.email.trim()?A(r.email.trim())?r.password.trim()?B(r.password.trim())?r.confirm_password.trim()?r.password.trim()!==r.confirm_password.trim()?(u(a("两次密码不一致")),e):(e=!0,w(!0),e):(u(a("确认密码不能为空")),e):(m(a("密码强度不够")),e):(m(a("密码不能为空")),e):(c(a("邮箱格式不正确")),e):(c(a("邮箱不能为空")),e)},E=async()=>{try{if(!N())return;const{code:e,data:y,msg:S}=await M.registerApi(r);if(e!==200){v.dialog.alert(S);return}await F(y.user_id,r.email),d.navigate("/login/",{props:{defaultData:r}})}catch{v.dialog.alert(a("注册失败,请稍后重试"))}finally{w(!1)}};return s.jsxs(k,{loginScreen:!0,noToolbar:!0,children:[s.jsx(h,{className:"fixed top-0 left-0",children:s.jsx(_,{className:"text-2xl text-primary",onClick:()=>d.back()})}),s.jsxs(h,{className:"px-2",children:[s.jsx(C,{children:a("注册")}),s.jsxs(j,{form:!0,children:[s.jsx(n,{label:a("用户名"),type:"text",placeholder:a("请输入用户名"),outline:!0,value:r.nickname,onInput:e=>{o({...r,nickname:e.target.value})},floatingLabel:!0,className:"el-input",children:s.jsx(b,{slot:"media",className:i("w-5 h-5 text-icon-60",l.ios&&"mt-1")})}),s.jsx(n,{label:a("邮箱"),type:"text",placeholder:a("请输入邮箱"),className:"el-input",outline:!0,value:r.email,onInput:e=>{o({...r,email:e.target.value}),c("")},floatingLabel:!0,errorMessage:p,errorMessageForce:!!p,children:s.jsx(L,{slot:"media",className:i("w-5 h-5 text-icon-60",l.ios&&"mt-1")})}),s.jsx(n,{label:a("密码"),type:"password",placeholder:a("请输入密码"),className:"el-input",outline:!0,value:r.password,onInput:e=>{o({...r,password:e.target.value}),m("")},floatingLabel:!0,errorMessage:f,errorMessageForce:!!f,children:s.jsx(b,{slot:"media",className:i("w-5 h-5 text-icon-60",l.ios&&"mt-1")})}),s.jsx(n,{label:a("确认密码"),type:"password",placeholder:a("请输入确认密码"),className:"el-input",outline:!0,value:r.confirm_password,onInput:e=>{o({...r,confirm_password:e.target.value}),u("")},floatingLabel:!0,errorMessage:x,errorMessageForce:!!x,children:s.jsx(L,{slot:"media",className:i("w-5 h-5 text-icon-60",l.ios&&"mt-1")})})]}),s.jsx(j,{inset:!0,children:s.jsx(P,{onClick:E,large:!0,className:"mx-[16px] mb-5",fill:!0,round:!0,text:a("注册"),children:g&&s.jsx(I,{size:"18",color:"white"})})})]})]})};export{z as default};
