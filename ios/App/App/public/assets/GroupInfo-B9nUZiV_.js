import{ac as E,e as S,r as l,aj as d,j as e,P as C,N as M,$ as G,L as g,m as n,n as L,ao as f,I as y,f as t}from"./index-BMnTsVIf.js";import{T as B}from"./toggle-C_Wfo19x.js";const R=E(S)||"",P=x=>{const{f7router:o,group_id:a}=x,[c,v]=l.useState(null),[h,p]=l.useState(!1),[i,w]=l.useState();l.useEffect(()=>{(async()=>{var m;const{code:s,data:r}=await d.groupInfoApi({group_id:a});if(s!==200)return;s===200&&w(r);const u=(m=r==null?void 0:r.preferences)==null?void 0:m.silent_notification;p(u===1)})()},[x]);const[b,_]=l.useState([]);l.useEffect(()=>{(async()=>{const{code:s,data:r}=await d.groupMemberApi({group_id:a});if(s!==200)return;const u=r.find(m=>m.user_id===R).identity;u&&v(u),_(r)})()},[x]);const k=async()=>{t.dialog.confirm("退出群聊","确定要退出群聊吗？",async()=>{try{t.dialog.preloader("正在退出...");const{code:s,msg:r}=await d.groupQuitApi({group_id:Number(a)});s===200&&o.back(),s!==200&&t.dialog.alert(r)}catch(s){t.dialog.alert(s.message,"退出失败...")}finally{t.dialog.close()}})},N=async()=>{t.dialog.confirm("解散群聊","确定要解散群聊吗？",async()=>{try{t.dialog.preloader("正在解散...");const{code:s,msg:r}=await d.groupDissolve({group_id:Number(a)});s===200&&o.back(),s!==200&&t.dialog.alert(r)}catch(s){t.dialog.alert(s.message,"解散失败...")}finally{t.dialog.close()}})},$=async()=>{const s=!h;p(s);try{t.dialog.preloader("请稍候...");const{code:r}=await d.setGroupSilenceApi({group_id:Number(a),is_silent:s?1:0});if(r!==200)return}catch(r){t.dialog.alert(r.message)}finally{t.dialog.close()}};//! 解决傻逼底部导航栏莫名其妙的显示问题
const j=(s=!1)=>{const r=document.getElementById("framework7-root");r&&(s?r.classList.remove("hidden-toolbar"):r.classList.add("hidden-toolbar"))};return e.jsxs(C,{noToolbar:!0,onPageBeforeIn:()=>j(!1),onPageBeforeOut:()=>j(!0),children:[e.jsx(M,{title:G("群聊信息"),backLink:!0,className:"bg-bgPrimary hidden-navbar-bg"}),e.jsx(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:e.jsx(n,{noChevron:!0,children:e.jsxs("div",{className:"w-full flex flex-col justify-center items-center",children:[e.jsxs("div",{className:"mb-1 w-full grid grid-cols-5 gap-6",children:[b.slice(0,23).map(s=>e.jsxs("div",{className:"w-12 h-[144rpx] flex flex-col items-center",children:[e.jsx("div",{className:"min-w-12 min-h-12 overflow-hidden",children:e.jsx(L,{size:50,square:!0,src:s.avatar})}),e.jsx("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},className:"w-12 min-w-12 min-h-6 flex-1 text-sm text-gray-400 max-w-12 overflow-hidden text-ellipsis",children:s.nickname})]},s.user_id)),e.jsx("div",{className:"w-12 h-12 flex flex-col justify-center items-center border-dashed border-[1px] border-gray-400 text-gray-500 rounded-lg",onClick:()=>o.navigate(`/group_info/${a}/member/${f.NOTMEMBER}`),children:e.jsx(y,{f7:"plus",size:18})}),c&&e.jsx("div",{className:"w-12 h-12 flex flex-col justify-center items-center border-dashed border-[1px] border-gray-400 text-gray-500 rounded-lg",onClick:()=>o.navigate(`/group_info/${a}/member/${f.MEMBER}`),children:e.jsx(y,{f7:"minus",size:18})})]}),b.length>0&&e.jsx("div",{className:"mb-1",children:e.jsx("span",{className:"text-sm text-gray-500",onClick:()=>o.navigate(`/group_info/${a}/member/${f.MEMBERSHOW}`),children:"查看更多群成员"})})]})})}),e.jsxs(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:[e.jsx(n,{title:"群聊名称",link:c===2?`/create_group/?id=${i==null?void 0:i.id}`:"",children:e.jsx("div",{slot:"after",children:e.jsx("span",{children:i==null?void 0:i.name})})}),e.jsx(n,{link:`/group_notice/${a}/?identity=${c}`,title:"群公告"}),e.jsx(n,{link:`/group_qrcode/?group_id=${a}`,title:"群二维码"}),e.jsx(n,{link:`/group_user_display_name/?group_id=${a}&remark=${i==null?void 0:i.preferences.remark}`,title:"我在群组的昵称",after:i==null?void 0:i.preferences.remark})]}),e.jsx(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,noChevron:!0,children:e.jsx(n,{title:"消息免打扰",children:e.jsx(B,{slot:"after",onChange:$,checked:h})})}),e.jsx(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:e.jsx(n,{noChevron:!0,link:!0,children:e.jsx("div",{slot:"inner",className:"w-full flex justify-center items-center",onClick:c?N:k,children:e.jsx("span",{className:"text-sm text-red-500",children:c===2?"解散群聊":"退出群聊"})})})})]})};export{P as default};
