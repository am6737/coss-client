import{v as C,e as E,r as a,ad as o,j as e,P as I,N as S,$ as M,L as u,l,ag as m,J as j,f as t}from"./index-Co9Jrsve.js";import{T as $}from"./toggle-Bw0qqYWm.js";const G=C(E)||"",T=x=>{const{f7router:n,group_id:i}=x,[g,b]=a.useState(null),[f,p]=a.useState(!1),[y,v]=a.useState({name:""});a.useEffect(()=>{(async()=>{var d;const{code:s,data:r}=await o.groupInfoApi({group_id:i});if(s!==200)return;console.log(r),s===200&&v(r);const c=(d=r==null?void 0:r.preferences)==null?void 0:d.silent_notification;p(c===1)})()},[]);const[h,N]=a.useState([]);a.useEffect(()=>{(async()=>{const{code:s,data:r}=await o.groupMemberApi({group_id:i});if(s!==200)return;const c=r.find(d=>d.user_id===G).identity;c&&b(c),N(r)})()},[x]);const k=async()=>{t.dialog.confirm("退出群聊","确定要退出群聊吗？",async()=>{try{t.dialog.preloader("正在退出...");const{code:s,msg:r}=await o.groupQuitApi({group_id:parseInt(i)});s===200&&n.back(),s!==200&&t.dialog.alert(r)}catch(s){t.dialog.alert(s.message,"退出失败...")}finally{t.dialog.close()}})},w=async()=>{t.dialog.confirm("解散群聊","确定要解散群聊吗？",async()=>{try{t.dialog.preloader("正在解散...");const{code:s,msg:r}=await o.groupDissolve({group_id:i});s===200&&n.back(),s!==200&&t.dialog.alert(r)}catch(s){t.dialog.alert(s.message,"解散失败...")}finally{t.dialog.close()}})},_=async()=>{const s=!f;p(s);try{t.dialog.preloader("请稍候...");const{code:r}=await o.setGroupSilenceApi({group_id:parseInt(i),is_silent:s?1:0});if(r!==200)return}catch(r){t.dialog.alert(r.message)}finally{t.dialog.close()}};return e.jsxs(I,{noToolbar:!0,children:[e.jsx(S,{title:M("群聊信息"),backLink:!0,className:"bg-bgPrimary hidden-navbar-bg"}),e.jsx(u,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:e.jsx(l,{noChevron:!0,children:e.jsxs("div",{className:"w-full flex flex-col justify-center items-center",children:[e.jsxs("div",{className:"mb-6 w-full grid grid-cols-5 gap-6",children:[h.slice(0,23).map(s=>e.jsxs("div",{className:"w-12 h-12 flex flex-col items-center",children:[e.jsx("img",{className:"rounded-lg",src:s.avatar,alt:""}),e.jsx("div",{className:"text-sm text-gray-400",children:s.nickname})]},s.user_id)),e.jsx("div",{className:"w-12 h-12 flex flex-col justify-center items-center border-dashed border-[1px] border-gray-400 text-gray-500 rounded-lg",onClick:()=>n.navigate(`/group_info/${i}/member/${m.NOTMEMBER}`),children:e.jsx(j,{f7:"plus",size:18})}),g&&e.jsx("div",{className:"w-12 h-12 flex flex-col justify-center items-center border-dashed border-[1px] border-gray-400 text-gray-500 rounded-lg",onClick:()=>n.navigate(`/group_info/${i}/member/${m.MEMBER}`),children:e.jsx(j,{f7:"minus",size:18})})]}),h.length>0&&e.jsx("div",{className:"mb-1",children:e.jsx("span",{className:"text-sm text-gray-500",onClick:()=>n.navigate(`/group_info/${i}/member/${m.MEMBERSHOW}`),children:"查看更多群成员"})})]})})}),e.jsxs(u,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:[e.jsx(l,{link:!0,title:"群聊名称",children:e.jsx("div",{slot:"after",children:e.jsx("span",{children:y.name})})}),e.jsx(l,{link:!0,title:"群公告"})]}),e.jsx(u,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,noChevron:!0,children:e.jsx(l,{title:"消息免打扰",children:e.jsx($,{slot:"after",onChange:_,checked:f})})}),e.jsx(u,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:e.jsx(l,{noChevron:!0,link:!0,children:e.jsx("div",{slot:"inner",className:"w-full flex justify-center items-center",onClick:g?w:k,children:e.jsx("span",{className:"text-sm text-red-500",children:g===2?"解散群聊":"退出群聊"})})})})]})};export{T as default};
