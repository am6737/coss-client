import{r as p,Q as m,j as e,P as h,N,$ as t,o as _,a as b,ar as f,K as v,as as k,ae as u,f as l}from"./index-Bku3qZqe.js";import{C as A,a as C}from"./card-DcP_RgLU.js";const G=({f7route:n,f7router:g})=>{var x;const r=n.params.group_id,c=p.useMemo(()=>{var a,s;return(a=n==null?void 0:n.query)!=null&&a.identity?parseInt((s=n==null?void 0:n.query)==null?void 0:s.identity)===2:!1},[(x=n==null?void 0:n.query)==null?void 0:x.identity]),[o,y]=p.useState(null),i=async()=>{const a=await u.groupAnnouncementApi({group_id:r});return y(a.data),(a==null?void 0:a.data)||[]};m(async()=>{i()},()=>{},[]);const j=async a=>{l.dialog.confirm(t("是否确认删除群公告?"),t("删除"),async()=>{try{const{code:s,msg:d}=await u.deleteGroupAnnouncementApi({group_id:parseInt(r),id:a});if(s!==200){l.dialog.alert(t(d||"删除群公告失败"));return}s===200&&i()}catch(s){return l.dialog.alert(t((s==null?void 0:s.message)||"删除群公告失败"))}finally{l.dialog.close()}})};return e.jsxs(h,{noToolbar:!0,className:"bg-bgTertiary",onPageBeforeIn:i,children:[e.jsx(N,{title:t("群公告"),backLink:!0,className:"bg-bgPrimary",children:e.jsx(_,{children:c&&e.jsx(b,{href:`/create_group_notice/${r}/?admin=${c}`,className:"text-2xl",children:e.jsx(f,{})})})}),o?o.map((a,s)=>e.jsx(A,{className:"coss_card_title m-3",children:e.jsx(C,{className:"flex justify-center flex-col",children:e.jsxs("div",{onClick:()=>g.navigate(`/create_group_notice/${r}/?id=${a.id}&admin=${c}`),children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-textPrimary text-base font-bold line-clamp-1 break-all",children:a.title}),c&&e.jsx("div",{onClick:d=>{d.stopPropagation(),j(a.id)},children:e.jsx(v,{className:"m-2",f7:"xmark_circle",size:18})})]}),e.jsx("div",{className:"my-2 text-textSecondary text-sm line-clamp-2 break-all",children:a.content}),e.jsxs("div",{className:"text-xs text-gray-400 flex justify-between items-center",children:[e.jsx("span",{className:"",children:k(a!=null&&a.updated_at?a==null?void 0:a.updated_at:a==null?void 0:a.created_at,"zh_CN")}),e.jsxs("span",{children:[a.read_user_list?a.read_user_list.length:0,"人已读"]})]})]})})},s)):e.jsx("p",{className:"text-center pt-5 text-textSecondary",children:t("暂无公告")})]})};export{G as default};
