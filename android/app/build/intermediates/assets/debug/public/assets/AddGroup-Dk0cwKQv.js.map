{"version":3,"file":"AddGroup-Dk0cwKQv.js","sources":["../../src/pages/AddGroup/AddGroup.tsx"],"sourcesContent":["import { Button, Navbar, Page } from 'framework7-react'\nimport GroupService from '@/api/group.ts'\nimport RelationService from '@/api/relation.ts'\nimport React, { useEffect, useState } from 'react'\nimport Avatar from '@/components/Avatar/Avatar.tsx'\nimport { $t, toastMessage } from '@/shared'\nimport useLoading from '@/hooks/useLoading.ts'\n\nconst AddGroup: React.FC<RouterProps> = ({ f7route, f7router }) => {\n\tconst groupId = f7route.query.group_id as string\n\tconst [groupInfo, setGroupInfo] = useState<any>()\n\tconst { watchAsyncFn } = useLoading()\n\tuseEffect(() => {\n\t\twatchAsyncFn(() =>\n\t\t\tGroupService.groupInfoApi({\n\t\t\t\tgroup_id: Number(groupId)\n\t\t\t})\n\t\t\t\t.then((res) => {\n\t\t\t\t\tif (res.code == 200) {\n\t\t\t\t\t\tsetGroupInfo(res.data)\n\t\t\t\t\t\t// 已经在群聊\n\t\t\t\t\t\tif (res.data.preferences) {\n\t\t\t\t\t\t\tf7router.navigate(`/group_info/${groupId}/`, { reloadCurrent: true })\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoastMessage($t('获取群信息失败'))\n\t\t\t\t\t\tconsole.log('获取群信息失败', res)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tconsole.log('获取群聊失败', err)\n\t\t\t\t})\n\t\t)\n\t}, [])\n\n\tconst addGroup = () => {\n\t\tRelationService.addGruop(Number(groupId)).then((res) => {\n\t\t\tconsole.log('添加群', res)\n\t\t\tif (res.code == 200) {\n\t\t\t\ttoastMessage($t('添加成功'))\n\t\t\t\tf7router.navigate('/dialog/')\n\t\t\t} else if (res.code == 400) {\n\t\t\t\ttoastMessage($t('已加入群聊'))\n\t\t\t} else {\n\t\t\t\ttoastMessage($t('添加失败'))\n\t\t\t}\n\t\t})\n\t}\n\n\treturn (\n\t\t<Page noToolbar>\n\t\t\t<Navbar backLink />\n\t\t\t{groupInfo ? (\n\t\t\t\t<div className=\"flex w-full h-full flex-col items-center\">\n\t\t\t\t\t<Avatar className=\"mt-20\" square src={groupInfo.avatar} />\n\t\t\t\t\t<span>{groupInfo.name}</span>\n\t\t\t\t\t<Button className=\"w-52 mt-50\" onClick={addGroup} fill large round>\n\t\t\t\t\t\t{$t('加入群聊')}\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t) : (\n\t\t\t\t<div className=\"flex w-full h-full justify-center items-center\">\n\t\t\t\t\t<div>二维码失效</div>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</Page>\n\t)\n}\n\nexport default AddGroup\n"],"names":["AddGroup","f7route","f7router","groupId","groupInfo","setGroupInfo","useState","watchAsyncFn","useLoading","useEffect","GroupService","res","toastMessage","$t","err","addGroup","RelationService","jsxs","Page","jsx","Navbar","Avatar","Button"],"mappings":"+GAQA,MAAMA,EAAkC,CAAC,CAAE,QAAAC,EAAS,SAAAC,KAAe,CAC5D,MAAAC,EAAUF,EAAQ,MAAM,SACxB,CAACG,EAAWC,CAAY,EAAIC,EAAc,SAAA,EAC1C,CAAE,aAAAC,GAAiBC,IACzBC,EAAAA,UAAU,IAAM,CACfF,EAAa,IACZG,EAAa,aAAa,CACzB,SAAU,OAAOP,CAAO,CAAA,CACxB,EACC,KAAMQ,GAAQ,CACVA,EAAI,MAAQ,KACfN,EAAaM,EAAI,IAAI,EAEjBA,EAAI,KAAK,aACZT,EAAS,SAAS,eAAeC,CAAO,IAAK,CAAE,cAAe,GAAM,IAGxDS,EAAAC,EAAG,SAAS,CAAC,EAClB,QAAA,IAAI,UAAWF,CAAG,EAC3B,CACA,EACA,MAAOG,GAAQ,CACP,QAAA,IAAI,SAAUA,CAAG,CAAA,CACzB,CAAA,CAEJ,EAAG,CAAE,CAAA,EAEL,MAAMC,EAAW,IAAM,CACtBC,EAAgB,SAAS,OAAOb,CAAO,CAAC,EAAE,KAAMQ,GAAQ,CAC/C,QAAA,IAAI,MAAOA,CAAG,EAClBA,EAAI,MAAQ,KACFC,EAAAC,EAAG,MAAM,CAAC,EACvBX,EAAS,SAAS,UAAU,GAClBS,EAAI,MAAQ,IACTC,EAAAC,EAAG,OAAO,CAAC,EAEXD,EAAAC,EAAG,MAAM,CAAC,CACxB,CACA,CAAA,EAID,OAAAI,EAAA,KAACC,EAAK,CAAA,UAAS,GACd,SAAA,CAACC,EAAAA,IAAAC,EAAA,CAAO,SAAQ,EAAC,CAAA,EAChBhB,EACAa,EAAA,KAAC,MAAI,CAAA,UAAU,2CACd,SAAA,CAAAE,MAACE,GAAO,UAAU,QAAQ,OAAM,GAAC,IAAKjB,EAAU,OAAQ,EACxDe,EAAAA,IAAC,OAAM,CAAA,SAAAf,EAAU,IAAK,CAAA,EACrBe,EAAA,IAAAG,EAAA,CAAO,UAAU,aAAa,QAASP,EAAU,KAAI,GAAC,MAAK,GAAC,MAAK,GAChE,SAAAF,EAAG,MAAM,EACX,CACD,CAAA,CAAA,QAEC,MAAI,CAAA,UAAU,iDACd,SAACM,EAAAA,IAAA,MAAA,CAAI,iBAAK,CACX,CAAA,CAEF,CAAA,CAAA,CAEF"}