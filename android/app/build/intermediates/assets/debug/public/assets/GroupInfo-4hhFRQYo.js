import{a9 as E,g as S,r as o,ah as d,j as e,P as C,N as M,$ as G,L as g,o as n,p as L,am as x,I as j,f as a}from"./index-D6xPw8DV.js";import{T as B}from"./toggle-DrqY1mOa.js";const R=E(S)||"",I=v=>{const{f7router:l,group_id:i}=v,[c,y]=o.useState(null),[f,h]=o.useState(!1),[t,w]=o.useState();o.useEffect(()=>{(async()=>{var m;const{code:s,data:r}=await d.groupInfoApi({group_id:i});if(s!==200)return;s===200&&w(r);const u=(m=r==null?void 0:r.preferences)==null?void 0:m.silent_notification;h(u===1)})()},[]);const[p,_]=o.useState([]);o.useEffect(()=>{(async()=>{const{code:s,data:r}=await d.groupMemberApi({group_id:i});if(s!==200)return;const u=r==null?void 0:r.find(m=>m.user_id===R).identity;u&&y(u),_(r)})()},[]);const k=async()=>{a.dialog.confirm("退出群聊","确定要退出群聊吗？",async()=>{try{a.dialog.preloader("正在退出...");const{code:s,msg:r}=await d.groupQuitApi({group_id:Number(i)});s===200&&l.back(),s!==200&&a.dialog.alert(r)}catch(s){a.dialog.alert(s.message,"退出失败...")}finally{a.dialog.close()}})},N=async()=>{a.dialog.confirm("解散群聊","确定要解散群聊吗？",async()=>{try{a.dialog.preloader("正在解散...");const{code:s,msg:r}=await d.groupDissolve({group_id:Number(i)});s===200&&l.back(),s!==200&&a.dialog.alert(r)}catch(s){a.dialog.alert(s.message,"解散失败...")}finally{a.dialog.close()}})},$=async()=>{const s=!f;h(s);try{const{code:r}=await d.setGroupSilenceApi({group_id:Number(i),is_silent:s?1:0});if(r!==200)return}catch(r){a.dialog.alert(r.message,"设置失败")}};//! 解决傻逼底部导航栏莫名其妙的显示问题
const b=(s=!1)=>{const r=document.getElementById("framework7-root");r&&(s?r.classList.remove("hidden-toolbar"):r.classList.add("hidden-toolbar"))};return e.jsxs(C,{noToolbar:!0,onPageBeforeIn:()=>b(!1),onPageBeforeOut:()=>b(!0),children:[e.jsx(M,{title:G("群聊信息"),backLink:!0,className:"hidden-navbar-bg"}),e.jsx(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:e.jsx(n,{noChevron:!0,children:e.jsxs("div",{className:"w-full flex flex-col justify-center items-center",children:[e.jsxs("div",{className:"mb-1 w-full grid grid-cols-5 gap-6",children:[p.slice(0,23).map(s=>e.jsxs("div",{className:"w-12 h-[144rpx] flex flex-col items-center",children:[e.jsx("div",{className:"min-w-12 min-h-12 overflow-hidden",children:e.jsx(L,{size:50,square:!0,src:s.avatar})}),e.jsx("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},className:"w-12 min-w-12 min-h-6 flex-1 text-sm text-gray-400 max-w-12 overflow-hidden text-ellipsis",children:s.nickname})]},s.user_id)),e.jsx("div",{className:"w-12 h-12 flex flex-col justify-center items-center border-dashed border-[1px] border-gray-400 text-gray-500 rounded-lg",onClick:()=>l.navigate(`/group_info/${i}/member/${x.NOTMEMBER}`),children:e.jsx(j,{f7:"plus",size:18})}),c&&e.jsx("div",{className:"w-12 h-12 flex flex-col justify-center items-center border-dashed border-[1px] border-gray-400 text-gray-500 rounded-lg",onClick:()=>l.navigate(`/group_info/${i}/member/${x.MEMBER}`),children:e.jsx(j,{f7:"minus",size:18})})]}),p.length>0&&e.jsx("div",{className:"mb-1",children:e.jsx("span",{className:"text-sm text-gray-500",onClick:()=>l.navigate(`/group_info/${i}/member/${x.MEMBERSHOW}`),children:"查看更多群成员"})})]})})}),e.jsxs(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:[e.jsx(n,{title:"群聊名称",link:c===2?`/create_group/?id=${t==null?void 0:t.id}`:"",children:e.jsx("div",{slot:"after",children:e.jsx("span",{children:t==null?void 0:t.name})})}),e.jsx(n,{link:`/group_notice/${i}/?identity=${c}`,title:"群公告"}),e.jsx(n,{link:`/group_qrcode/?group_id=${i}`,title:"群二维码"}),e.jsx(n,{link:`/group_user_display_name/?group_id=${i}&remark=${t==null?void 0:t.preferences.remark}`,title:"我在群组的昵称",after:t==null?void 0:t.preferences.remark})]}),e.jsx(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,noChevron:!0,children:e.jsx(n,{title:"消息免打扰",children:e.jsx(B,{slot:"after",onChange:$,checked:f})})}),e.jsx(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:e.jsx(n,{noChevron:!0,link:!0,children:e.jsx("div",{slot:"inner",className:"w-full flex justify-center items-center",onClick:c?N:k,children:e.jsx("span",{className:"text-sm text-red-500",children:c===2?"解散群聊":"退出群聊"})})})})]})};export{I as default};
//# sourceMappingURL=GroupInfo-4hhFRQYo.js.map
