{"version":3,"file":"UserRemark-BLqqeeHH.js","sources":["../../src/pages/UserRemark/UserRemark.tsx"],"sourcesContent":["// 用户的备注\nimport { Link, Navbar, NavRight, Page } from 'framework7-react'\nimport { useState } from 'react'\nimport RelationService from '@/api/relation'\nimport { toastMessage } from '@/shared'\nimport CommInput from '@/components/CommInput/CommInput'\nimport useLoading from '@/hooks/useLoading'\nimport useCacheStore from '@/stores/cache'\n\nconst UserRemark: React.FC<RouterProps> = ({ f7route, f7router }) => {\n\tconst oldRemark = f7route.query.remark\n\tconst [remark, setRemark] = useState()\n\tconst userId = f7route.query.user_id\n\tconst { watchAsyncFn } = useLoading()\n\tconst cacheStore = useCacheStore()\n\n\tconst handlerSubmit = () => {\n\t\twatchAsyncFn(() =>\n\t\t\tRelationService.setUserRemark({\n\t\t\t\tuser_id: userId!,\n\t\t\t\tremark: remark!\n\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\t// 修改\n\t\t\t\t\tcacheStore.updateCacheContactsObj(\n\t\t\t\t\t\tcacheStore.cacheDialogs.map((item) => {\n\t\t\t\t\t\t\tif (item?.user_id === userId) {\n\t\t\t\t\t\t\t\titem.dialog_name = remark\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn item\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\tf7router.back(`/profile/${userId}/`)\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\ttoastMessage('修改失败')\n\t\t\t\t})\n\t\t)\n\t}\n\n\treturn (\n\t\t<Page noToolbar>\n\t\t\t<Navbar backLink>\n\t\t\t\t<NavRight>\n\t\t\t\t\t<Link onClick={handlerSubmit}>提交</Link>\n\t\t\t\t</NavRight>\n\t\t\t</Navbar>\n\t\t\t<div className=\"flex h-full flex-col\">\n\t\t\t\t<div>\n\t\t\t\t\t<h1 className=\"text-center text-xl font-bold mt-10 mb-5\">设定备注</h1>\n\t\t\t\t\t<CommInput title=\"备注\" defaultValue={oldRemark} onChange={(value: any) => setRemark(value)} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Page>\n\t)\n}\n\nexport default UserRemark\n"],"names":["UserRemark","f7route","f7router","oldRemark","remark","setRemark","useState","userId","watchAsyncFn","useLoading","cacheStore","useCacheStore","handlerSubmit","RelationService","item","toastMessage","jsxs","Page","jsx","Navbar","NavRight","Link","CommInput","value"],"mappings":"yGASA,MAAMA,EAAoC,CAAC,CAAE,QAAAC,EAAS,SAAAC,KAAe,CAC9D,MAAAC,EAAYF,EAAQ,MAAM,OAC1B,CAACG,EAAQC,CAAS,EAAIC,EAAS,SAAA,EAC/BC,EAASN,EAAQ,MAAM,QACvB,CAAE,aAAAO,GAAiBC,IACnBC,EAAaC,IAEbC,EAAgB,IAAM,CAC3BJ,EAAa,IACZK,EAAgB,cAAc,CAC7B,QAASN,EACT,OAAAH,CAAA,CACA,EACC,KAAK,IAAM,CAEAM,EAAA,uBACVA,EAAW,aAAa,IAAKI,KACxBA,GAAA,YAAAA,EAAM,WAAYP,IACrBO,EAAK,YAAcV,GAEbU,EACP,CAAA,EAEOZ,EAAA,KAAK,YAAYK,CAAM,GAAG,CAAA,CACnC,EACA,MAAM,IAAM,CACZQ,EAAa,MAAM,CAAA,CACnB,CAAA,CACH,EAIA,OAAAC,EAAA,KAACC,EAAK,CAAA,UAAS,GACd,SAAA,CAACC,EAAA,IAAAC,EAAA,CAAO,SAAQ,GACf,SAACD,EAAAA,IAAAE,EAAA,CACA,SAACF,EAAAA,IAAAG,EAAA,CAAK,QAAST,EAAe,SAAE,IAAA,CAAA,CACjC,CAAA,EACD,EACCM,MAAA,MAAA,CAAI,UAAU,uBACd,gBAAC,MACA,CAAA,SAAA,CAACA,EAAA,IAAA,KAAA,CAAG,UAAU,2CAA2C,SAAI,OAAA,EAC7DA,EAAAA,IAACI,EAAU,CAAA,MAAM,KAAK,aAAcnB,EAAW,SAAWoB,GAAelB,EAAUkB,CAAK,CAAG,CAAA,CAAA,CAAA,CAC5F,CACD,CAAA,CACD,CAAA,CAAA,CAEF"}