import{a9 as C,e as S,r as o,ad as c,j as e,P as $,N as I,$ as M,L as g,l as d,ah as x,K as y,f as t}from"./index-CyFq9ppu.js";import{T as G}from"./toggle-aaGGTprW.js";const L=C(S)||"",T=f=>{const{f7router:l,group_id:i}=f,[a,v]=o.useState(null),[h,p]=o.useState(!1),[n,w]=o.useState();o.useEffect(()=>{(async()=>{var m;const{code:s,data:r}=await c.groupInfoApi({group_id:i});if(s!==200)return;s===200&&w(r);const u=(m=r==null?void 0:r.preferences)==null?void 0:m.silent_notification;p(u===1)})()},[f]);const[b,N]=o.useState([]);o.useEffect(()=>{(async()=>{const{code:s,data:r}=await c.groupMemberApi({group_id:i});if(s!==200)return;const u=r.find(m=>m.user_id===L).identity;u&&v(u),N(r)})()},[f]);const k=async()=>{t.dialog.confirm("退出群聊","确定要退出群聊吗？",async()=>{try{t.dialog.preloader("正在退出...");const{code:s,msg:r}=await c.groupQuitApi({group_id:parseInt(i)});s===200&&l.back(),s!==200&&t.dialog.alert(r)}catch(s){t.dialog.alert(s.message,"退出失败...")}finally{t.dialog.close()}})},_=async()=>{t.dialog.confirm("解散群聊","确定要解散群聊吗？",async()=>{try{t.dialog.preloader("正在解散...");const{code:s,msg:r}=await c.groupDissolve({group_id:i});s===200&&l.back(),s!==200&&t.dialog.alert(r)}catch(s){t.dialog.alert(s.message,"解散失败...")}finally{t.dialog.close()}})},E=async()=>{const s=!h;p(s);try{t.dialog.preloader("请稍候...");const{code:r}=await c.setGroupSilenceApi({group_id:parseInt(i),is_silent:s?1:0});if(r!==200)return}catch(r){t.dialog.alert(r.message)}finally{t.dialog.close()}};//! 解决傻逼底部导航栏莫名其妙的显示问题
const j=(s=!1)=>{const r=document.getElementById("framework7-root");r&&(s?r.classList.remove("hidden-toolbar"):r.classList.add("hidden-toolbar"))};return e.jsxs($,{noToolbar:!0,onPageBeforeIn:()=>j(!1),onPageBeforeOut:()=>j(!0),children:[e.jsx(I,{title:M("群聊信息"),backLink:!0,className:"bg-bgPrimary hidden-navbar-bg"}),e.jsx(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:e.jsx(d,{noChevron:!0,children:e.jsxs("div",{className:"w-full flex flex-col justify-center items-center",children:[e.jsxs("div",{className:"mb-1 w-full grid grid-cols-5 gap-6",children:[b.slice(0,23).map(s=>e.jsxs("div",{className:"w-12 h-[144rpx] flex flex-col items-center",children:[e.jsx("div",{className:"min-w-12 min-h-12 bg-gray-200 rounded-lg overflow-hidden",children:e.jsx("img",{src:s.avatar,alt:""})}),e.jsx("div",{className:"w-12 min-w-12 min-h-6 flex-1 text-sm text-gray-400 max-w-12 overflow-hidden text-ellipsis",children:s.nickname})]},s.user_id)),e.jsx("div",{className:"w-12 h-12 flex flex-col justify-center items-center border-dashed border-[1px] border-gray-400 text-gray-500 rounded-lg",onClick:()=>l.navigate(`/group_info/${i}/member/${x.NOTMEMBER}`),children:e.jsx(y,{f7:"plus",size:18})}),a&&e.jsx("div",{className:"w-12 h-12 flex flex-col justify-center items-center border-dashed border-[1px] border-gray-400 text-gray-500 rounded-lg",onClick:()=>l.navigate(`/group_info/${i}/member/${x.MEMBER}`),children:e.jsx(y,{f7:"minus",size:18})})]}),b.length>0&&e.jsx("div",{className:"mb-1",children:e.jsx("span",{className:"text-sm text-gray-500",onClick:()=>l.navigate(`/group_info/${i}/member/${x.MEMBERSHOW}`),children:"查看更多群成员"})})]})})}),e.jsxs(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:[e.jsx(d,{title:"群聊名称",link:a===2?`/add_group/?id=${n==null?void 0:n.id}`:a===2,children:e.jsx("div",{slot:"after",children:e.jsx("span",{children:n==null?void 0:n.name})})}),e.jsx(d,{link:`/group_notice/${i}/?identity=${a}`,title:"群公告"})]}),e.jsx(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,noChevron:!0,children:e.jsx(d,{title:"消息免打扰",children:e.jsx(G,{slot:"after",onChange:E,checked:h})})}),e.jsx(g,{className:"m-0 mb-3 bg-white",strong:!0,dividers:!0,outline:!0,children:e.jsx(d,{noChevron:!0,link:!0,children:e.jsx("div",{slot:"inner",className:"w-full flex justify-center items-center",onClick:a?_:k,children:e.jsx("span",{className:"text-sm text-red-500",children:a===2?"解散群聊":"退出群聊"})})})})]})};export{T as default};
