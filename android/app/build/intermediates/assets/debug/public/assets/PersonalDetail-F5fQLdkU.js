import{r as i,j as e,I as y,P as b,N as f,J as N,a as x,K as k,O as L,$ as a,o as P,L as g,Q as R,l as h,U as S,f as l,H as T}from"./index-CyFq9ppu.js";import{L as w}from"./list-button-DmtekqvR.js";import{L as A}from"./list-input-Bi4f3OEe.js";const C=({opened:c,onPopupClosed:r,title:o,send:n})=>{const[t,d]=i.useState("");return e.jsx(y,{opened:c,onPopupClosed:()=>r(!1),children:e.jsxs(b,{className:"bg-bgTertiary",children:[e.jsxs(f,{className:"hidden-navbar-bg bg-bgPrimary coss_remark",children:[e.jsx(N,{children:e.jsx(x,{popupClose:!0,children:e.jsx(k,{icon:"icon-back"})})}),e.jsx(L,{children:o||a("添加好友")}),e.jsx(P,{children:e.jsx(x,{onClick:async()=>{await n(t),r(!1)},children:a("发送")})})]}),e.jsx(g,{strongIos:!0,outlineIos:!0,dividersIos:!0,form:!0,formStoreData:!0,className:"bg-bgPrimary",children:e.jsx(A,{name:"name",type:"text",onChange:u=>d(u.target.value),clearButton:!0,autofocus:!0,placeholder:a("请输入备注信息")})})]})})},H=({f7route:c})=>{const r=c.params.user_id,o=i.useRef({el:null}),n=i.useRef(null),[t,d]=i.useState({}),u=()=>{const s=n.current.offsetHeight;o.current.el.querySelector(".page-content").scrollTop=s/2};R(async()=>{try{const{data:s}=await S.getUserInfoApi({user_id:r});d(s)}catch(s){console.error("获取用户信息失败",s)}},()=>{},[]);const[j,p]=i.useState(!1),v=async s=>{try{l.dialog.preloader(a("添加中..."));const{code:m}=await T.addFriendApi({user_id:r,remark:s,e2e_public_key:""});if(m!==200){l.dialog.alert(a("添加失败"));return}l.dialog.alert(a("添加成功,等待对方同意"))}catch(m){console.error(m)}finally{l.dialog.close()}};return e.jsxs(b,{ref:o,className:"profile-page bg-bgTertiary",noToolbar:!0,onPageInit:u,children:[e.jsx(f,{title:a("用户信息"),backLink:!0,className:"bg-bgPrimary hidden-navbar-bg"}),e.jsx("div",{className:"profile-avatar-block",ref:n,children:e.jsx("img",{src:t==null?void 0:t.avatar,alt:""})}),e.jsxs("div",{className:"profile-content",children:[e.jsxs(g,{strong:!0,outline:!0,dividers:!0,mediaList:!0,className:"no-margin-top m-0 mb-3 bg-white",children:[e.jsx(h,{title:t==null?void 0:t.nickname}),e.jsx(h,{subtitle:t==null?void 0:t.signature,text:t==null?void 0:t.email})]}),e.jsx(g,{strong:!0,outline:!0,dividers:!0,className:"bg-white m-0 mb-3",children:e.jsx(w,{onClick:()=>p(!0),children:a("添加好友")})})]}),e.jsx(C,{opened:j,onPopupClosed:p,send:v})]})};export{H as default};
