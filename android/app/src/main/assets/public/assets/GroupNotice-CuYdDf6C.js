import{r as g,a0 as N,j as r,P as C,N as b,$ as o,C as S,b as $,ab as w,I as k,ah as _,f as i}from"./index-D6xPw8DV.js";import{C as A,a as D}from"./card-BzxAURFv.js";var f=["second","minute","hour","day","week","month","year"];function I(e,t){if(t===0)return["just now","right now"];var n=f[Math.floor(t/2)];return e>1&&(n+="s"),[e+" "+n+" ago","in "+e+" "+n]}var E=["秒","分钟","小时","天","周","个月","年"];function G(e,t){if(t===0)return["刚刚","片刻后"];var n=E[~~(t/2)];return[e+" "+n+"前",e+" "+n+"后"]}var p={},j=function(e,t){p[e]=t},P=function(e){return p[e]||p.en_US},x=[60,60,24,7,365/7/12,12];function v(e){return e instanceof Date?e:!isNaN(e)||/^\d+$/.test(e)?new Date(parseInt(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(e))}function L(e,t){var n=e<0?1:0;e=Math.abs(e);for(var l=e,s=0;e>=x[s]&&s<x.length;s++)e/=x[s];return e=Math.floor(e),s*=2,e>(s===0?9:1)&&(s+=1),t(e,s,l)[n].replace("%s",e.toString())}function U(e,t){var n=t?v(t):new Date;return(+n-+v(e))/1e3}var z=function(e,t,n){var l=U(e,n&&n.relativeDate);return L(l,P(t))};j("en_US",I);j("zh_CN",G);const q=({f7route:e,f7router:t})=>{var h;const n=e.params.group_id,l=g.useMemo(()=>{var a,c;return(a=e==null?void 0:e.query)!=null&&a.identity?parseInt((c=e==null?void 0:e.query)==null?void 0:c.identity)===2:!1},[(h=e==null?void 0:e.query)==null?void 0:h.identity]),[s,y]=g.useState(null),d=async()=>{const a=await _.groupAnnouncementApi({group_id:n});return y(a.data),(a==null?void 0:a.data)||[]};N(async()=>{d()},()=>{},[]);const m=async a=>{i.dialog.confirm(o("是否确认删除群公告?"),o("删除"),async()=>{try{const{code:c,msg:u}=await _.deleteGroupAnnouncementApi({group_id:parseInt(n),id:a});if(c!==200){i.dialog.alert(o(u||"删除群公告失败"));return}c===200&&d()}catch(c){return i.dialog.alert(o((c==null?void 0:c.message)||"删除群公告失败"))}finally{i.dialog.close()}})};return r.jsxs(C,{noToolbar:!0,onPageBeforeIn:d,children:[r.jsx(b,{title:o("群公告"),backLink:!0,children:r.jsx(S,{children:l&&r.jsx($,{href:`/create_group_notice/${n}/?admin=${l}`,className:"text-2xl",children:r.jsx(w,{})})})}),s?s.map((a,c)=>r.jsx(A,{className:"coss_card_title m-3",children:r.jsx(D,{className:"flex justify-center flex-col",children:r.jsxs("div",{onClick:()=>t.navigate(`/create_group_notice/${n}/?id=${a.id}&admin=${l}`),children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("div",{className:"text-textPrimary text-base font-bold line-clamp-1 break-all",children:a.title}),l&&r.jsx("div",{onClick:u=>{u.stopPropagation(),m(a.id)},children:r.jsx(k,{className:"m-2",f7:"xmark_circle",size:18})})]}),r.jsx("div",{className:"my-2 text-textSecondary text-sm line-clamp-2 break-all",children:a.content}),r.jsxs("div",{className:"text-xs text-gray-400 flex justify-between items-center",children:[r.jsx("span",{className:"",children:z(a!=null&&a.updated_at?a==null?void 0:a.updated_at:a==null?void 0:a.created_at,"zh_CN")}),r.jsxs("span",{children:[a.read_user_list?a.read_user_list.length:0,"人已读"]})]})]})})},c)):r.jsx("p",{className:"text-center pt-5 text-textSecondary",children:o("暂无公告")})]})};export{q as default};
//# sourceMappingURL=GroupNotice-CuYdDf6C.js.map
