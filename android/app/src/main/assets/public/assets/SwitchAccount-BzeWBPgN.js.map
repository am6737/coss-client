{"version":3,"file":"SwitchAccount-BzeWBPgN.js","sources":["../../src/pages/SwitchAccount/SwitchAccount.tsx"],"sourcesContent":["import { f7, Icon, Navbar, Page } from 'framework7-react'\nimport Avatar from '@/components/Avatar/Avatar.tsx'\nimport React, { useEffect, useState } from 'react'\nimport { Device } from '@capacitor/device'\nimport UserService from '@/api/user.ts'\nimport { ACCOUNT, TOKEN, USER_ID } from '@/shared'\nimport { setCookie } from '@/utils/cookie.ts'\nimport useUserStore from '@/stores/user.ts'\nimport useLoading from '@/hooks/useLoading.ts'\n\nconst style = {\n\tmargin: '0 20px',\n\tmarginBottom: '10px',\n\tbackground: 'var(--coss-background-primary)',\n\tpadding: '15px',\n\tborderRadius: '5px'\n}\n\nconst SwitchAccount: React.FC<RouterProps> = ({ f7router }) => {\n\tconst [userList, setUserList] = useState<any[any]>()\n\tconst userId = localStorage.getItem('__USER_ID__')\n\tuseEffect(() => {\n\t\tconst temp: any = localStorage.getItem('user_list')\n\t\tsetUserList(JSON.parse(temp))\n\t\tconsole.log('账号列表数据', userList)\n\t}, [])\n\tconst { watchAsyncFn } = useLoading()\n\n\tconst userStore = useUserStore()\n\tconst submit = async (index: number) => {\n\t\tconsole.log('切换账号', userList)\n\t\tif (userId == userList[index].user_id) return\n\n\t\tconst { identifier: driver_id } = await Device.getId()\n\t\tconsole.log(userList.password)\n\n\t\tconst { code, data, msg } = await watchAsyncFn(() =>\n\t\t\tUserService.loginApi({\n\t\t\t\tpassword: userList[index].password,\n\t\t\t\temail: userList[index].email,\n\t\t\t\tdriver_id,\n\t\t\t\tplatform: 'ios',\n\t\t\t\tdriver_token: '7bd439461e80d13a889e08d0c351fdcfa2c697b920536b4a3787ecf69a5206dc'\n\t\t\t})\n\t\t)\n\n\t\tconsole.log('登录', data)\n\t\tif (code !== 200) {\n\t\t\tf7.dialog.alert(msg)\n\t\t\treturn\n\t\t}\n\n\t\tsetCookie(USER_ID, data?.user_info?.user_id)\n\t\tsetCookie(ACCOUNT, data?.user_info?.email)\n\t\tsetCookie(TOKEN, data?.token)\n\n\t\tuserStore.update({\n\t\t\tuserId: data?.user_info?.user_id,\n\t\t\ttoken: data?.token,\n\t\t\tuserInfo: data?.user_info,\n\t\t\tdeviceId: driver_id\n\t\t})\n\t\tlocation.reload()\n\t}\n\n\treturn (\n\t\t<Page className=\"bg-bgTertiary\" noToolbar>\n\t\t\t<Navbar backLink />\n\t\t\t<h1 className=\"text-center mt-20 text-2xl\">点击头像切换账号</h1>\n\t\t\t<div className=\"mt-20 \">\n\t\t\t\t{userList &&\n\t\t\t\t\tuserList.map((item: any, index: number) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div onClick={() => submit(index)} key={item.user_id} style={style} className=\"flex\">\n\t\t\t\t\t\t\t\t<Avatar square src={item.avatar} />\n\t\t\t\t\t\t\t\t<div className=\"flex flex-col flex-1 justify-center ml-2\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex w-full justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-lg\">{item.nickname}</span>\n\t\t\t\t\t\t\t\t\t\t{userId == item.user_id && <span className=\"text-green-600\">目前使用</span>}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<span className=\"text-textSecondary\">{item.coss_id}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)\n\t\t\t\t\t})}\n\t\t\t\t<div\n\t\t\t\t\tonClick={() => f7router.navigate(`/login/?switch_account=${true}`)}\n\t\t\t\t\tstyle={style}\n\t\t\t\t\tclassName=\"flex items-center\"\n\t\t\t\t>\n\t\t\t\t\t<div className=\"w-12 h-12 flex flex-col justify-center items-center border-dashed border-[1px] border-gray-400 text-gray-500 rounded-lg\">\n\t\t\t\t\t\t<Icon f7=\"plus\" size={18} />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"ml-2 text-textSecondary text-lg\">\n\t\t\t\t\t\t<span>新增账号</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Page>\n\t)\n}\n\nexport default SwitchAccount\n"],"names":["style","SwitchAccount","f7router","userList","setUserList","useState","userId","useEffect","temp","watchAsyncFn","useLoading","userStore","useUserStore","submit","index","driver_id","Device","code","data","msg","UserService","f7","setCookie","USER_ID","_a","ACCOUNT","_b","TOKEN","_c","jsxs","Page","jsx","Navbar","item","Avatar","Icon"],"mappings":"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"}