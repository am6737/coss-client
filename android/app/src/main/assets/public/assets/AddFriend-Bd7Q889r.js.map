{"version":3,"file":"AddFriend-Bd7Q889r.js","sources":["../../src/pages/AddFriend/AddFriend.tsx"],"sourcesContent":["import { List, ListItem, Navbar, Page, Searchbar, Subnavbar, f7 } from 'framework7-react'\nimport { useState } from 'react'\n\nimport { $t } from '@/shared'\nimport './AddFriend.scss'\nimport UserService from '@/api/user'\nimport useCacheStore from '@/stores/cache'\n\nconst AddFriend: React.FC<RouterProps> = ({ f7router }) => {\n\tconst [keyWord, setKeyword] = useState<string>('')\n\n\tconst cacheStore = useCacheStore()\n\n\tconst search = async () => {\n\t\t// if (!validEmail(keyWord)) return f7.dialog.alert($t('请输入正确的邮箱地址'))\n\t\ttry {\n\t\t\tf7.dialog.preloader($t('搜索中...'))\n\n\t\t\t// 先查找本地好友列表，查看是否是自己好友\n\t\t\tconst user = cacheStore.cacheContacts?.find((v) => v?.email === keyWord)\n\n\t\t\tif (user) {\n\t\t\t\tf7router.navigate(`/profile/${user.user_id}/`)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst { data } = await UserService.searchUserApi({ email: keyWord })\n\n\t\t\tif (!data) {\n\t\t\t\tf7.dialog.alert($t('搜索用户不存在'))\n\t\t\t\treturn\n\t\t\t}\n\t\t\tf7router.navigate(`/personal_detail/${data.user_id}/`)\n\t\t} catch (error) {\n\t\t\tconsole.error('搜索用户失败', error)\n\t\t\tf7.dialog.alert($t('搜索用户失败'))\n\t\t} finally {\n\t\t\tf7.dialog.close()\n\t\t}\n\t}\n\n\treturn (\n\t\t<Page noToolbar className=\"bg-bgTertiary coss_add\">\n\t\t\t<Navbar className=\"hidden-navbar-bg bg-bgPrimary\" backLink title={$t('添加好友')}>\n\t\t\t\t<Subnavbar inner={false} className=\"bg-bgPrimary coss_navbar_search\">\n\t\t\t\t\t<Searchbar\n\t\t\t\t\t\tplaceholder={$t('搜索邮箱')}\n\t\t\t\t\t\tdisableButtonText={$t('取消')}\n\t\t\t\t\t\tonChange={(e) => setKeyword(e.target.value)}\n\t\t\t\t\t\tonClickClear={() => setKeyword('')}\n\t\t\t\t\t\tonClickDisable={() => f7router.back()}\n\t\t\t\t\t/>\n\t\t\t\t</Subnavbar>\n\t\t\t</Navbar>\n\n\t\t\t<List className=\"m-0 bg-bgPrimary py-2\">\n\t\t\t\t{!!keyWord && (\n\t\t\t\t\t<ListItem link onClick={search}>\n\t\t\t\t\t\t<div className=\"flex items-center max-w-[70%] overflow-hidden text-ellipsis whitespace-nowrap line-clamp-1\">\n\t\t\t\t\t\t\t{$t(`查找：`)}\n\t\t\t\t\t\t\t<span className=\"text-primary\">{keyWord}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</ListItem>\n\t\t\t\t)}\n\t\t\t</List>\n\t\t</Page>\n\t)\n}\n\nexport default AddFriend\n"],"names":["AddFriend","f7router","keyWord","setKeyword","useState","cacheStore","useCacheStore","search","f7","$t","user","_a","v","data","UserService","error","jsxs","Page","jsx","Navbar","Subnavbar","Searchbar","e","List","ListItem"],"mappings":"0JAQA,MAAMA,EAAmC,CAAC,CAAE,SAAAC,KAAe,CAC1D,KAAM,CAACC,EAASC,CAAU,EAAIC,WAAiB,EAAE,EAE3CC,EAAaC,IAEbC,EAAS,SAAY,OAEtB,GAAA,CACHC,EAAG,OAAO,UAAUC,EAAG,QAAQ,CAAC,EAG1B,MAAAC,GAAOC,EAAAN,EAAW,gBAAX,YAAAM,EAA0B,KAAMC,IAAMA,GAAA,YAAAA,EAAG,SAAUV,GAEhE,GAAIQ,EAAM,CACTT,EAAS,SAAS,YAAYS,EAAK,OAAO,GAAG,EAC7C,MACD,CAEM,KAAA,CAAE,KAAAG,CAAS,EAAA,MAAMC,EAAY,cAAc,CAAE,MAAOZ,CAAA,CAAS,EAEnE,GAAI,CAACW,EAAM,CACVL,EAAG,OAAO,MAAMC,EAAG,SAAS,CAAC,EAC7B,MACD,CACAR,EAAS,SAAS,oBAAoBY,EAAK,OAAO,GAAG,QAC7CE,EAAO,CACP,QAAA,MAAM,SAAUA,CAAK,EAC7BP,EAAG,OAAO,MAAMC,EAAG,QAAQ,CAAC,CAAA,QAC3B,CACDD,EAAG,OAAO,OACX,CAAA,EAGD,OACEQ,EAAAA,KAAAC,EAAA,CAAK,UAAS,GAAC,UAAU,yBACzB,SAAA,CAAAC,MAACC,EAAO,CAAA,UAAU,gCAAgC,SAAQ,GAAC,MAAOV,EAAG,MAAM,EAC1E,SAACS,EAAAA,IAAAE,EAAA,CAAU,MAAO,GAAO,UAAU,kCAClC,SAAAF,EAAA,IAACG,EAAA,CACA,YAAaZ,EAAG,MAAM,EACtB,kBAAmBA,EAAG,IAAI,EAC1B,SAAWa,GAAMnB,EAAWmB,EAAE,OAAO,KAAK,EAC1C,aAAc,IAAMnB,EAAW,EAAE,EACjC,eAAgB,IAAMF,EAAS,KAAK,CAAA,GAEtC,CACD,CAAA,QAECsB,EAAK,CAAA,UAAU,wBACd,SAAA,CAAC,CAACrB,GACFgB,EAAA,IAACM,EAAS,CAAA,KAAI,GAAC,QAASjB,EACvB,SAACS,EAAAA,KAAA,MAAA,CAAI,UAAU,6FACb,SAAA,CAAAP,EAAG,KAAK,EACRS,EAAA,IAAA,OAAA,CAAK,UAAU,eAAgB,SAAQhB,EAAA,CAAA,CACzC,CAAA,CACD,CAAA,EAEF,CACD,CAAA,CAAA,CAEF"}